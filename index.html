<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>UTC Clock and Availability Spreadsheet</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <details>
      <summary><h1>UTC Clock & Global Timezones</h1></summary>
      <div id="utc-clock" class="clock">--:--:--</div>

      <h2>All Timezones</h2>
      <table id="timezone-table">
        <thead>
          <tr><th>Timezone</th><th>Local Time (24h)</th><th>Local Time (12h)</th></tr>
        </thead>
        <tbody>
          <!-- dynamically populated -->
        </tbody>
      </table>
    </details>

    <details>
      <summary><h2>Availability Spreadsheet</h2></summary>
      <button id="add-row">Add Row</button>
      <button id="save-file">Save to File</button>
      <button id="load-file">Load from File</button>
      <input type="file" id="load-file-input" accept=".json" style="display:none;">
      <div class="search-tool">
          <input type="text" id="search-person-input" placeholder="Search for a person..." autocomplete="off">
          <div id="search-suggestions" class="suggestions-list"></div>
      </div>
      <table id="availability-table">
        <thead>
          <tr>
            <th>Icon</th>
            <th>Username</th>
            <th>Notes</th>
            <th>DST</th>
            <th>UTC Offset</th>
            <th>Available Times</th>
            <th>Timezone Actions</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <!-- dynamically added rows -->
        </tbody>
      </table>
    </details>

    <details class="availability-summary-details">
      <summary><h3>Availability Summary</h3></summary>
      <div class="availability-summary-content">
        <div class="summary-counts">
          <p>Available: <span id="available-count">0</span></p>
          <p>Not Available: <span id="not-available-count">0</span></p>
        </div>
        <div class="summary-lists">
          <div class="available-list">
            <h4>Available People (<span id="available-list-count">0</span>)</h4>
            <ul id="available-ul"></ul>
          </div>
          <div class="not-available-list">
            <h4>Not Available People (<span id="not-available-list-count">0</span>)</h4>
            <ul id="not-available-ul"></ul>
          </div>
        </div>
        <div class="best-time-section">
          <h4>Best Time for Collaboration</h4>

          <!-- New: Date Picker -->
          <div class="date-picker-container">
            <label for="selected-date">Select Date:</label>
            <input type="date" id="selected-date">
          </div>

          <!-- New: Mode Selector -->
          <div class="time-slot-mode-selector">
              <button id="mode-optimal-times" class="selected">Optimal Times</button>
              <button id="mode-hourly-slots">All Hourly Slots</button>
          </div>

          <!-- New: Time Slots Buttons Container -->
          <div class="time-slots-container">
            <label>Time Slots:</label>
            <div id="availability-time-slots-container" class="time-slots-buttons-container">
              <!-- Buttons will be dynamically populated here -->
            </div>
          </div>

          <div class="viewer-timezone-controls">
              <span>Your Timezone:</span>
              <select id="viewer-utc-offset"></select>
              <label><input type="checkbox" id="viewer-dst"> DST</label>
              <!-- New: Time display toggle button -->
              <button id="toggle-best-time-display-mode" class="time-display-toggle-btn">Show Local Time</button>
          </div>
          <div class="people-filter-controls">
              <span>Filter by People:</span>
              <div id="people-filter-checkboxes" class="checkbox-list-container">
                <!-- Checkboxes will be dynamically populated here -->
              </div>
              <button id="clear-people-filter">Clear Filter</button>
          </div>
          <p id="best-time-output">Calculating...</p>
          <p id="best-time-local-24h" class="best-time-local-output"></p>
          <p id="best-time-local-12h" class="best-time-local-output"></p>
        </div>
      </div>
    </details>

    <details class="discord-embed-details">
      <summary><h3>Discord Embeds</h3></summary>
      <div id="discord-embed-container" class="embed-container">
          <div id="embed-spot-left" class="embed-spot">
              <p class="placeholder-message">Right-click here to embed content (Left).</p>
          </div>
          <div id="embed-spot-right" class="embed-spot">
              <p class="placeholder-message">Right-click here to embed content (Right).</p>
          </div>
      </div>
    </details>

    <!-- New: Experimental/Beta Features section -->
    <details id="experimental-features" class="experimental-features" style="display:none;">
      <summary><h3>Experimental / Beta Features</h3></summary>
      <div class="experimental-content">
        <div class="worst-time-section best-time-section">
          <h4>Worst Time for Collaboration</h4>
          <p id="worst-time-output">Calculating...</p>
          <p id="worst-time-local-24h" class="best-time-local-output"></p>
          <p id="worst-time-local-12h" class="best-time-local-output"></p>
          <details class="people-list-dropdown">
            <summary>People Status at Worst Time (<span id="worst-time-status-count">0</span>)</summary>
            <ul id="worst-time-status-list-ul"></ul>
          </details>
        </div>
      </div>
    </details>

  </div>

  <!-- Custom Context Menu Modal -->
  <div id="embed-code-modal" class="modal-overlay">
      <div class="modal-content">
          <h4>Embed Web Content</h4>
          <p>Paste HTML embed code (e.g., iframe for Discord widget):</p>
          <textarea id="embed-code-input" placeholder="<iframe src='...' width='...' height='...'></iframe>"></textarea>
          <div class="modal-buttons">
              <button id="embed-code-submit">Embed</button>
              <button id="embed-code-cancel">Cancel</button>
          </div>
      </div>
  </div>

  <!-- New Note Viewer Modal -->
  <div id="note-viewer-modal" class="modal-overlay">
      <div class="modal-content">
          <h4 id="note-viewer-title"></h4>
          <p id="note-viewer-content" class="note-viewer-text"></p>
          <div class="modal-buttons">
              <button id="note-viewer-close">Close</button>
          </div>
      </div>
  </div>

  <!-- New: Settings icon and panel -->
  <button id="settings-icon" class="settings-icon" title="Settings">⚙️</button>
  <div id="settings-panel" class="settings-panel">
    <h4>Settings</h4>
    <label><input type="checkbox" id="toggle-experimental"> Show Experimental/Beta Features</label>
  </div>

  <script type="module" src="app.js"></script>
</body>
</html>